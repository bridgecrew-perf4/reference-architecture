{
  "ok": false,
  "vulnerabilities": [
    {
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L/E:P",
      "alternativeIds": [],
      "creationTime": "2021-03-30T09:49:33.483598Z",
      "credit": [
        "Unknown"
      ],
      "cvssScore": 7.7,
      "description": "## Overview\n[netmask](https://www.npmjs.org/package/netmask) is a library to parse IPv4 CIDR blocks.\n\nAffected versions of this package are vulnerable to Server-side Request Forgery (SSRF). It incorrectly evaluates individual IPv4 octets that contain octal strings as left-stripped integers, leading to an inordinate attack surface on hundreds of thousands of projects that rely on `netmask` to filter or evaluate IPv4 block ranges, both inbound and outbound.\r\n\r\nFor example, a remote unauthenticated attacker can request local resources using input data `0177.0.0.1` (`127.0.0.1`), which `netmask` evaluates as the public IP `177.0.0.1`.\r\nContrastingly, a remote authenticated or unauthenticated attacker can input the data `0127.0.0.01` (`87.0.0.1`) as localhost, yet the input data is a public IP and can potentially cause local and remote file inclusion (LFI/RFI).\r\nA remote authenticated or unauthenticated attacker can bypass packages that rely on `netmask` to filter IP address blocks to reach intranets, VPNs, containers, adjacent VPC instances, or LAN hosts, using input data such as `012.0.0.1` (`10.0.0.1`), which `netmask` evaluates as `12.0.0.1` (public).\n## Remediation\nUpgrade `netmask` to version 2.0.1 or higher.\n## References\n- [GitHub Commit](https://github.com/rs/node-netmask/commit/3f19a056c4eb808ea4a29f234274c67bc5a848f4)\n- [PoC](https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md)\n- [Researcher Report](https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918/)\n",
      "disclosureTime": "2021-03-29T21:32:05Z",
      "exploit": "Proof of Concept",
      "functions": [],
      "fixedIn": [
        "2.0.1"
      ],
      "id": "SNYK-JS-NETMASK-1089716",
      "identifiers": {
        "CWE": [
          "CWE-918",
          "CWE-20"
        ],
        "GHSA": [
          "GHSA-pch5-whg9-qr2r"
        ],
        "CVE": [
          "CVE-2021-28918",
          "CVE-2021-29418"
        ]
      },
      "language": "js",
      "malicious": false,
      "modificationTime": "2021-09-18T15:25:00.367421Z",
      "moduleName": "netmask",
      "packageManager": "npm",
      "packageName": "netmask",
      "patches": [],
      "proprietary": false,
      "publicationTime": "2021-03-30T14:57:04Z",
      "references": [
        {
          "title": "GitHub Commit",
          "url": "https://github.com/rs/node-netmask/commit/3f19a056c4eb808ea4a29f234274c67bc5a848f4"
        },
        {
          "title": "PoC",
          "url": "https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md"
        },
        {
          "title": "Researcher Report",
          "url": "https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918/"
        }
      ],
      "severity": "high",
      "severityWithCritical": "high",
      "socialTrendAlert": false,
      "title": "Server-side Request Forgery (SSRF)",
      "insights": {
        "triageAdvice": null
      },
      "functions_new": [],
      "semver": {
        "vulnerable": [
          "<2.0.1"
        ]
      },
      "from": [
        "ionic@5.4.16",
        "@ionic/discover@2.0.8",
        "netmask@1.0.6"
      ],
      "upgradePath": [
        false,
        false,
        "netmask@2.0.1"
      ],
      "version": "1.0.6",
      "name": "netmask",
      "isUpgradable": false,
      "isPatchable": false,
      "isPinnable": false
    },
    {
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P",
      "alternativeIds": [],
      "creationTime": "2021-08-15T12:18:11.115775Z",
      "credit": [
        "Tim Perry"
      ],
      "cvssScore": 8.1,
      "description": "## Overview\n\nAffected versions of this package are vulnerable to Remote Code Execution (RCE). This can occur when used with untrusted input, due to unsafe PAC file handling.\r\n\r\nIn order to exploit this vulnerability in practice, this either requires an attacker on your local network, a specific vulnerable configuration, or some second vulnerability that allows an attacker to set your config values.\r\n\r\n**NOTE:** The fix for this vulnerability is applied in the `node-degenerator` library, a dependency is written by the same maintainer. \r\n\r\n\r\n### PoC\r\n```js\r\nconst pac = require('pac-resolver');\r\n\r\n// Should keep running forever (if not vulnerable):\r\nsetInterval(() => {\r\n    console.log(\"Still running\");\r\n}, 1000);\r\n\r\n// Parsing a malicious PAC file unexpectedly executes unsandboxed code:\r\npac(`\r\n    // Real PAC config:\r\n    function FindProxyForURL(url, host) {\r\n        return \"DIRECT\";\r\n    }\r\n\r\n    // But also run arbitrary code:\r\n    var f = this.constructor.constructor(\\`\r\n        // Running outside the sandbox:\r\n        console.log('Read env vars:', process.env);\r\n        console.log('!!! PAC file is running arbitrary code !!!');\r\n        console.log('Can read & could exfiltrate env vars ^');\r\n        console.log('Can kill parsing process, like so:');\r\n        process.exit(100); // Kill the vulnerable process\r\n        // etc etc\r\n    \\`);\r\n\r\n    f();\r\n\r\n```\n## Remediation\nUpgrade `pac-resolver` to version 5.0.0 or higher.\n## References\n- [GitHub Commit #1](https://github.com/TooTallNate/node-degenerator/commit/ccc3445354135398b6eb1a04c7d27c13b833f2d5)\n- [GitHub Commit #2](https://github.com/TooTallNate/node-degenerator/commit/9d25bb67d957bc2e5425fea7bf7a58b3fc64ff9e)\n- [Github Release](https://github.com/TooTallNate/node-pac-resolver/releases/tag/5.0.0)\n- [Researcher Blog](https://httptoolkit.tech/blog/npm-pac-proxy-agent-vulnerability/)\n",
      "disclosureTime": "2021-05-30T13:37:37Z",
      "exploit": "Proof of Concept",
      "functions": [],
      "fixedIn": [
        "5.0.0"
      ],
      "id": "SNYK-JS-PACRESOLVER-1564857",
      "identifiers": {
        "CWE": [
          "CWE-94"
        ],
        "CVE": [
          "CVE-2021-23406"
        ]
      },
      "language": "js",
      "malicious": false,
      "modificationTime": "2022-03-13T12:34:39.028969Z",
      "moduleName": "pac-resolver",
      "packageManager": "npm",
      "packageName": "pac-resolver",
      "patches": [],
      "proprietary": true,
      "publicationTime": "2021-08-22T13:26:31Z",
      "references": [
        {
          "title": "GitHub Commit #1",
          "url": "https://github.com/TooTallNate/node-degenerator/commit/ccc3445354135398b6eb1a04c7d27c13b833f2d5"
        },
        {
          "title": "GitHub Commit #2",
          "url": "https://github.com/TooTallNate/node-degenerator/commit/9d25bb67d957bc2e5425fea7bf7a58b3fc64ff9e"
        },
        {
          "title": "Github Release",
          "url": "https://github.com/TooTallNate/node-pac-resolver/releases/tag/5.0.0"
        },
        {
          "title": "Researcher Blog",
          "url": "https://httptoolkit.tech/blog/npm-pac-proxy-agent-vulnerability/"
        }
      ],
      "severity": "high",
      "severityWithCritical": "high",
      "socialTrendAlert": false,
      "title": "Remote Code Execution (RCE)",
      "insights": {
        "triageAdvice": null
      },
      "functions_new": [],
      "semver": {
        "vulnerable": [
          "<5.0.0"
        ]
      },
      "from": [
        "ionic@5.4.16",
        "superagent-proxy@2.1.0",
        "proxy-agent@4.0.1",
        "pac-proxy-agent@4.1.0",
        "pac-resolver@4.2.0"
      ],
      "upgradePath": [
        false,
        "superagent-proxy@3.0.0",
        "proxy-agent@5.0.0",
        "pac-proxy-agent@5.0.0",
        "pac-resolver@5.0.0"
      ],
      "version": "4.2.0",
      "name": "pac-resolver",
      "isUpgradable": true,
      "isPatchable": false,
      "isPinnable": false
    }
  ],
  "numDependencies": 228,
  "severityMap": {
    "critical": 0,
    "high": 2,
    "medium": 0,
    "low": 0
  },
  "severityThreshold": "high",
  "org": "ussba",
  "packageManager": "npm",
  "licenseEnabled": true,
  "summary": "2 high severity vulnerable dependency paths",
  "filesystemPolicy": false,
  "filtered": {
    "ignore": [],
    "patch": []
  },
  "uniqueCount": 2,
  "path": "ionic"
}
